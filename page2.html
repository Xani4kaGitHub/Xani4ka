<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Хани молодец</title>
  <style>
    body {
      font-family: sans-serif;
      background: #1e1e1e;
      color: #fff;
      padding: 20px;
    }
    textarea {
      width: 100%;
      height: 150px;
      background: #2e2e2e;
      color: #fff;
      font-family: monospace;
      padding: 10px;
      border: none;
      resize: vertical;
    }
    #output {
      margin-top: 20px;
      padding: 15px;
      background: #2a2a2a;
      border-radius: 10px;
      font-size: 20px;
      white-space: pre-wrap;
      word-break: break-word;
    }
    .bold { font-weight: bold; }
    .italic { font-style: italic; }
    .underline { text-decoration: underline; }

    footer {
      margin-top: 40px;
      text-align: center;
      color: #aaa;
      font-size: 14px;
    }
  </style>
</head>
<body>
  <h1>Просмотр RGB Текста Minecraft</h1>
  <p>Вставь сюда текст с §, & или &# цветами:</p>
  <textarea id="input" placeholder="Вставь форматированный текст здесь..."></textarea>
  <div id="output"></div>

  <footer>
    created by Xani4ka
  </footer>

  <script>
    const input = document.getElementById('input');
    const output = document.getElementById('output');

    function parseLine(text) {
      const formatting = {
        'l': 'bold',
        'o': 'italic',
        'n': 'underline',
        'r': 'reset'
      };

      const hexChar = /(?:§x(?:§[0-9A-Fa-f]){6})|(?:&x(?:&[0-9A-Fa-f]){6})|(?:&#[0-9A-Fa-f]{6})/g;
      const simpleChar = /[§&][0-9a-fk-or]/gi;

      let result = '';
      let index = 0;
      let currentColor = '';
      let classes = [];

      function wrap(content) {
        return `<span style="${currentColor ? `color:${currentColor};` : ''}" class="${classes.join(' ')}">${content}</span>`;
      }

      const matches = [...text.matchAll(new RegExp(`${hexChar.source}|${simpleChar.source}`, 'g'))];

      for (let i = 0; i < matches.length; i++) {
        const match = matches[i];
        const start = match.index;
        const end = match.index + match[0].length;

        if (index < start) {
          result += wrap(text.slice(index, start));
        }

        const code = match[0];

        if (code.startsWith('§x') || code.startsWith('&x')) {
          const chars = code.match(/[0-9a-fA-F]/g);
          if (chars && chars.length === 6) {
            currentColor = '#' + chars.join('');
          }
        } else if (code.startsWith('&#')) {
          currentColor = code.slice(1);
        } else {
          const char = code.slice(1).toLowerCase();
          if (char === 'r') {
            currentColor = '';
            classes = [];
          } else if (formatting[char]) {
            classes.push(formatting[char]);
          }
        }

        index = end;
      }

      if (index < text.length) {
        result += wrap(text.slice(index));
      }

      return result;
    }

    input.addEventListener('input', () => {
      const lines = input.value.split('\n');
      output.innerHTML = lines.map(line => parseLine(line)).join('<br>');
    });
  </script>
</body>
</html>
